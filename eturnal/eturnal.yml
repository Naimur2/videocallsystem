# eTURN Configuration for MediaSoup Video Call
# Clean, modern configuration - much simpler than CoTURN!

eturnal:
  ## Listening addresses and ports
  listen:
    - ip: "::"
      port: 3478
      transport: udp
    - ip: "::"
      port: 3478
      transport: tcp
    - ip: "::"
      port: 5349
      transport: tls

  ## Relay configuration
  relay_ipv4_addr: "0.0.0.0"
  relay_min_port: 49152
  relay_max_port: 49171  # Only 20 ports for t2.large efficiency

  ## Authentication - supports both static and REST API
  auth_type: long_term
  realm: "eturnal.net"
  
  ## Users (will be overridden by environment variables)
  users:
    mediasoup: "mediasoupTurn2024!"

  ## Logging with enhanced debugging
  log_level: debug
  log_dir: "/var/log/eturnal"
  log_rotate_size: 10485760  # 10MB
  log_rotate_count: 5
  
  ## Performance tuning for t2.large
  max_allocations: 100
  max_permissions: 10
  max_bps: 1000000  # 1 Mbps per allocation
  
  ## TLS configuration (optional)
  tls_crt_file: "/etc/ssl/certs/ssl-cert-snakeoil.pem"
  tls_key_file: "/etc/ssl/private/ssl-cert-snakeoil.key"
  
  ## Blacklist private networks for security
  blacklist:
    - "127.0.0.0/8"
    - "10.0.0.0/8"
    - "172.16.0.0/12"
    - "192.168.0.0/16"

## Module configuration
modules:
  mod_log_stun: {}
  mod_stats_prometheus: 
    port: 8080
    ip: "127.0.0.1"